# ASpider 财经信息分析

## 项目介绍

基于多类型数据源 + 信息分析Agent，对财经信息进行实时分析并生成报告。
通过多信息面分析行业板块趋势，解读国家政策与经济动向。

### 系统目标

```
┌─────────────────────────────────────────────────────────────────┐
│                      用户价值主张                                │
├─────────────────────────────────────────────────────────────────┤
│  通过AI分析多维度数据，为用户提供：                              │
│  ✓ 政策解读 - 国家政策对行业板块的影响分析                       │
│  ✓ 板块趋势 - 行业/概念板块的资金流向与热度分析                  │
│  ✓ 关联分析 - 政策+资金+新闻的综合研判                           │
│  ✗ 不提供：具体买卖建议、个股推荐                                │
└─────────────────────────────────────────────────────────────────┘
```

## 系统架构

### 整体设计：采集即向量化架构

采用**采集时即向量化**的设计，支持每日自动分析和用户实时查询。

```
┌─────────────────────────────────────────────────────────────┐
│  数据采集流程（定时执行）                                    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  数据源抓取 → 清洗去重 → 摘要提取(LLM) → 向量化 → 存储ES    │
│                                                             │
│  处理内容：                                                 │
│  ├─ 标题 → titleVector（Embedding）                        │
│  ├─ 正文 → 摘要提取(LLM) → summary                         │
│  └─ 摘要 → summaryVector（Embedding）                      │
│                                                             │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│  分析流程（每日自动 / 用户触发）                            │
├─────────────────────────────────────────────────────────────┤
│  1. 数据检索：向量语义检索相关新闻 + 结构化数据查询         │
│  2. Agent分析：多Agent并行分析（消息面/资金面/趋势）        │
│  3. 报告生成：整合各Agent输出，生成结构化报告               │
└─────────────────────────────────────────────────────────────┘
```

### 设计优势

| 特性 | 说明 |
|-----|------|
| 查询零延迟 | 采集时已完成向量化，查询时直接检索 |
| 语义检索 | 向量化支持"半导体"匹配"集成电路"等语义关联 |
| 支持自动分析 | 每日Top板块分析无需等待向量化处理 |
| 数据分层 | 热/温/冷三层生命周期管理，平衡成本与价值 |

## 数据层设计

### 数据源矩阵

| 数据类型 | 数据源 | 采集频率 | 用途 |
|---------|--------|---------|------|
| **财经新闻** | 东方财富 | 每2小时 | 政策解读、行业动态 |
| **板块资金流向** | 东方财富 | 盘中实时(每30分钟) + 收盘后 | 主力资金动向分析 |
| **板块行情数据** | 东方财富 | 每日收盘后 | 板块涨跌趋势 |

### 定时任务汇总

| 任务 | cron表达式 | 执行时间 | 说明 |
|-----|-----------|---------|------|
| 新闻数据采集 | `0 0 0/2 * * ?` | 每2小时 | 采集+摘要提取+向量化 |
| 板块资金盘中采集 | `0 0/30 9-11,13-15 * * MON-FRI` | 交易时段每30分钟 | 实时监控资金流向 |
| 板块资金收盘采集 | `0 30 15 * * MON-FRI` | 每日15:30 | 当日完整数据 |
| 板块行情收盘采集 | `0 35 15 * * MON-FRI` | 每日15:35 | 采集当日板块行情 |
| 过期新闻清理 | `0 0 2 * * ?` | 每日凌晨2:00 | 分层清理（见生命周期设计） |

### 新闻数据生命周期

采用**热/温/冷三层**数据生命周期管理，平衡存储成本与分析价值。

```
┌─────────────────────────────────────────────────────────────────┐
│  新闻数据生命周期                                                │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  【热数据】0-7天                                                 │
│  ├─ 全量保留，含向量                                            │
│  └─ 用途：短期分析、实时热点追踪、每日Top分析                   │
│                                                                 │
│  【温数据】7-90天                                                │
│  ├─ 全量保留，含向量（从热数据自然过渡）                        │
│  └─ 用途：中期趋势分析、政策影响追踪、历史对比                  │
│                                                                 │
│  【冷数据】90天以上                                              │
│  ├─ 仅保留重要新闻（importance >= 3）                           │
│  ├─ 普通新闻删除                                                │
│  └─ 用途：长期趋势、重大事件回溯                                │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

#### 清理策略

```java
// 每日凌晨2:00执行
public void cleanupExpiredNews() {
    // 1. 90天前的普通新闻：删除
    deleteByQuery("importance < 3 AND crawlTime < now-90d");

    // 2. 90天前的重要新闻：保留
    // 重要新闻判定：政策类、重大事件、高关注度
}
```

#### 重要性评分规则

| 评分 | 等级 | 判定条件 |
|-----|------|---------|
| 5 | 重大 | 国家级政策、央行/证监会公告 |
| 4 | 重要 | 部委政策、行业重大事件 |
| 3 | 关注 | 地方政策、龙头企业动态 |
| 2 | 一般 | 行业新闻、市场评论 |
| 1 | 普通 | 资讯、快讯 |

### 数据模型

#### FinancialArticle（财经新闻）

```
FinancialArticle
├── uniqueId        # 去重标识（title + url 的 MD5）
├── title           # 标题
├── titleVector     # 标题向量（采集时生成）
├── contentUrl      # 文章详情URL
├── content         # 正文内容
├── summary         # 摘要（若文章本身无，采集时LLM提取）
├── summaryVector   # 摘要向量（采集时生成）
├── importance      # 重要性评分 1-5（用于冷数据筛选）
├── newsType        # 新闻类型：POLICY/EVENT/INDUSTRY/GENERAL
├── publishTime     # 发布时间
└── crawlTime       # 爬取时间
```

#### SectorMoneyFlow（板块资金流向）

```
SectorMoneyFlow
├── uniqueId              # 唯一标识 (sectorCode + tradeDate 的MD5)
├── sectorCode            # 板块代码 (如 BK0477)
├── sectorName            # 板块名称 (如 半导体)
├── sectorType            # 板块类型 (INDUSTRY/CONCEPT)
├── tradeDate             # 交易日期
├── changePercent         # 涨跌幅(%)
├── mainNetInflow         # 主力净流入(元)
├── mainNetInflowRatio    # 主力净流入占比(%)
├── superLargeInflow      # 超大单净流入(元)
├── superLargeInflowRatio # 超大单净流入占比(%)
├── largeInflow           # 大单净流入(元)
├── largeInflowRatio      # 大单净流入占比(%)
├── mediumInflow          # 中单净流入(元)
├── mediumInflowRatio     # 中单净流入占比(%)
├── smallInflow           # 小单净流入(元)
├── smallInflowRatio      # 小单净流入占比(%)
├── leadStock             # 领涨股票代码
├── leadStockName         # 领涨股票名称
└── crawlTime             # 爬取时间
```

#### SectorQuote（板块行情）

```
SectorQuote
├── uniqueId           # 唯一标识
├── sectorCode         # 板块代码
├── sectorName         # 板块名称
├── sectorType         # 板块类型
├── tradeDate          # 交易日期
├── openPrice          # 开盘价
├── closePrice         # 收盘价
├── highPrice          # 最高价
├── lowPrice           # 最低价
├── changePercent      # 涨跌幅
├── turnoverRate       # 换手率
├── amount             # 成交额
└── companyCount       # 成分股数量
```

## Agent分析层设计

### Agent架构

```
┌───────────────────────────────────────────────────────────────┐
│                      AnalysisAgentOrchestrator                │
│                         (分析编排器)                           │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐           │
│  │ PolicyAgent │  │ SectorAgent │  │ TrendAgent  │           │
│  │  政策分析    │  │  板块分析    │  │  趋势研判   │           │
│  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘           │
│         │                │                │                   │
│         └────────────────┼────────────────┘                   │
│                          ↓                                    │
│                 ┌─────────────────┐                           │
│                 │  ReportGenerator │                          │
│                 │   报告生成器      │                          │
│                 └─────────────────┘                           │
└───────────────────────────────────────────────────────────────┘
```

### Agent职责

| Agent | 输入数据 | 分析维度 | 输出 |
|-------|---------|---------|------|
| **PolicyAgent** | FinancialArticle | 政策类新闻识别→受益/受损板块映射 | 政策影响分析 |
| **SectorAgent** | SectorMoneyFlow + SectorQuote | 资金流向+涨跌幅+换手率 | 板块热度评估 |
| **TrendAgent** | 多日数据 | 连续N日趋势+资金持续性 | 趋势研判 |
| **ReportGenerator** | 各Agent输出 | 综合整理 | 结构化分析报告 |

## 模块结构

项目采用**两层架构**设计，清晰划分数据层与分析层职责：

| 层级 | 包路径 | 职责 |
|-----|-------|------|
| **数据层** | `data.*` | 数据采集、处理、向量化、存储 |
| **分析层** | `analysis.*` | 数据检索、Agent分析、报告生成 |
| **接口层** | `api.*` | 对外REST接口 |
| **通用层** | `common.*` | 配置、工具、异常处理 |

```
com.ershi.aspider
│
├── data/                                    # ═══════【数据层】═══════
│   │
│   ├── datasource/                          # 数据源模块
│   │   ├── domain/
│   │   │   ├── FinancialArticle.java            # 财经新闻实体
│   │   │   ├── FinancialArticleDSTypeEnum.java  # 新闻数据源类型
│   │   │   ├── NewsTypeEnum.java                # 新闻类型枚举
│   │   │   ├── SectorMoneyFlow.java             # 板块资金流向实体
│   │   │   ├── SectorQuote.java                 # 板块行情实体
│   │   │   └── SectorTypeEnum.java              # 板块类型枚举
│   │   ├── provider/
│   │   │   ├── FinancialArticleDataSource.java  # 新闻数据源接口
│   │   │   ├── EastMoneyFinancialArticleDS.java # 东财新闻实现
│   │   │   ├── SectorMoneyFlowDataSource.java   # 资金流向数据源接口
│   │   │   ├── EastMoneySectorMoneyFlowDS.java  # 东财资金流向实现
│   │   │   ├── SectorQuoteDataSource.java       # 板块行情数据源接口
│   │   │   └── EastMoneySectorQuoteDS.java      # 东财板块行情实现
│   │   └── service/
│   │       └── FinancialArticleDSFactory.java   # 新闻数据源工厂
│   │
│   ├── processor/                           # 数据处理模块
│   │   ├── cleaner/                         # 数据清洗（去重、文本清理）
│   │   │   ├── FinancialArticleCleaner.java
│   │   │   └── FinancialArticleClearEsDTO.java
│   │   ├── extractor/                       # 摘要提取（LLM摘要生成）
│   │   │   ├── ContentExtractor.java
│   │   │   ├── config/
│   │   │   ├── domain/
│   │   │   ├── service/
│   │   │   └── strategy/
│   │   └── scorer/                          # 重要性评分
│   │       ├── ArticleScorer.java
│   │       ├── config/
│   │       ├── domain/
│   │       └── strategy/
│   │
│   ├── embedding/                           # 向量化模块
│   │   ├── EmbeddingExecutor.java               # 向量化执行器
│   │   ├── config/
│   │   │   └── EmbeddingConfig.java
│   │   ├── domain/
│   │   │   └── EmbeddingProviderEnum.java
│   │   └── service/
│   │       ├── EmbeddingService.java            # Embedding服务接口
│   │       └── impl/
│   │           ├── QwenEmbeddingService.java    # 通义千问实现
│   │           ├── ZhipuEmbeddingService.java   # 智谱实现
│   │           └── OpenAiEmbeddingService.java  # OpenAI实现
│   │
│   ├── storage/                             # 存储模块
│   │   └── elasticsearch/
│   │       ├── config/
│   │       │   └── ElasticsearchConfig.java
│   │       └── service/
│   │           ├── FinancialArticleStorageService.java  # 新闻存储+检索
│   │           ├── SectorMoneyFlowStorageService.java   # 资金流向存储+检索
│   │           └── SectorQuoteStorageService.java       # 板块行情存储+检索
│   │
│   ├── orchestration/                       # 数据编排模块
│   │   └── service/
│   │       ├── FinancialArticleDataService.java  # 新闻数据编排（采集→处理→存储）
│   │       └── SectorDataService.java            # 板块数据编排
│   │
│   └── job/                                 # 定时任务模块
│       ├── FinancialArticleDataJob.java         # 新闻采集+过期清理
│       └── SectorMoneyFlowDataJob.java          # 板块数据采集
│
│
├── analysis/                                # ═══════【分析层】═══════
│   │
│   ├── retriever/                           # 数据检索模块
│   │   ├── DataRetriever.java                   # 检索器接口
│   │   ├── NewsRetriever.java                   # 新闻语义检索（向量KNN）
│   │   ├── SectorDataRetriever.java             # 板块数据检索（结构化查询）
│   │   └── domain/
│   │       ├── NewsRetrievalResult.java         # 新闻检索结果
│   │       └── SectorAnalysisData.java          # 板块分析数据（含聚合指标）
│   │
│   ├── agent/                               # Agent分析模块
│   │   ├── core/
│   │   │   ├── Agent.java                       # Agent接口
│   │   │   ├── PolicyAgent.java                 # 政策分析Agent
│   │   │   ├── SectorAgent.java                 # 板块分析Agent
│   │   │   └── TrendAgent.java                  # 趋势研判Agent
│   │   ├── prompt/
│   │   │   ├── PromptTemplate.java              # Prompt模板接口
│   │   │   ├── PolicyPromptTemplate.java        # 政策分析Prompt
│   │   │   ├── SectorPromptTemplate.java        # 板块分析Prompt
│   │   │   └── TrendPromptTemplate.java         # 趋势研判Prompt
│   │   └── domain/
│   │       ├── AnalysisRequest.java             # 分析请求
│   │       ├── PolicyImpact.java                # 政策影响结果
│   │       ├── SectorHeat.java                  # 板块热度结果
│   │       └── TrendSignal.java                 # 趋势信号结果
│   │
│   ├── report/                              # 报告生成模块
│   │   ├── ReportGeneratorService.java          # 报告生成服务
│   │   └── domain/
│   │       ├── AnalysisReport.java              # 完整分析报告
│   │       ├── SignalCard.java                  # L1信号卡片
│   │       ├── DataDashboard.java               # L2数据看板
│   │       └── DetailAnalysis.java              # L3详细分析
│   │
│   └── orchestration/                       # 分析编排模块
│       └── AnalysisAgentOrchestrator.java       # Agent编排器
│
│
├── api/                                     # ═══════【接口层】═══════
│   └── controller/
│       ├── AnalysisController.java              # 分析接口（触发分析）
│       └── ReportController.java                # 报告查询接口
│
│
└── common/                                  # ═══════【通用层】═══════
    ├── config/
    │   ├── ThreadPoolConfig.java                # 线程池配置
    │   └── MyThreadFactory.java
    ├── exception/
    │   └── GlobalThreadUncaughtExceptionHandler.java
    └── util/
        ├── BatchUtils.java                      # 批处理工具
        └── TextTruncateUtil.java                # 文本截断工具
```

### 层级依赖关系

```
┌─────────────────────────────────────────────────────────────┐
│                         api                                  │
│                    (AnalysisController)                      │
└──────────────────────────┬──────────────────────────────────┘
                           │ 调用
                           ▼
┌─────────────────────────────────────────────────────────────┐
│                       analysis                               │
│  ┌───────────────┐    ┌───────────────┐    ┌─────────────┐  │
│  │  orchestration │───▶│    agent      │───▶│   report    │  │
│  └───────┬───────┘    └───────────────┘    └─────────────┘  │
│          │                                                   │
│          ▼                                                   │
│  ┌───────────────┐                                          │
│  │   retriever    │  ← 向量检索 + 结构化查询                  │
│  └───────┬───────┘                                          │
└──────────┼──────────────────────────────────────────────────┘
           │ 调用
           ▼
┌─────────────────────────────────────────────────────────────┐
│                         data                                 │
│  ┌─────────────┐    ┌───────────────┐    ┌───────────────┐  │
│  │   storage    │◀───│ orchestration │◀───│     job       │  │
│  └──────▲──────┘    └───────┬───────┘    └───────────────┘  │
│         │                   │                                │
│         │           ┌───────▼───────┐                       │
│  ┌──────┴──────┐    │   processor    │                       │
│  │  embedding   │◀───│ cleaner/      │                       │
│  └─────────────┘    │ extractor/    │                       │
│                     │ scorer        │                       │
│                     └───────┬───────┘                       │
│                             │                                │
│                     ┌───────▼───────┐                       │
│                     │  datasource    │  ← 东财API            │
│                     └───────────────┘                       │
└─────────────────────────────────────────────────────────────┘
                           │
                           ▼
┌─────────────────────────────────────────────────────────────┐
│                        common                                │
│              (config / util / exception)                     │
└─────────────────────────────────────────────────────────────┘
```

## 执行流程

### 1. 数据采集流程（定时执行）

```
┌─────────────────────────────────────────────────────────────┐
│  定时任务层                                                  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  FinancialArticleDataJob       SectorMoneyFlowDataJob       │
│  (每2小时 + 凌晨清理)           (盘中每30分钟 + 收盘后)       │
│       │                                │                    │
│       ↓                                ↓                    │
│  ┌─────────────┐               ┌───────────────┐            │
│  │ 东财新闻API  │               │ 东财板块API   │            │
│  └──────┬──────┘               └───────┬───────┘            │
│         │                              │                    │
│         ↓                              ↓                    │
│  ┌─────────────┐               ┌───────────────┐            │
│  │ 清洗+去重   │                │ 资金流向数据  │            │
│  └──────┬──────┘               │ 板块行情数据  │            │
│         │                      └───────┬───────┘            │
│         ↓                              │                    │
│  ┌─────────────────┐                   │                    │
│  │ 摘要提取(LLM)   │                   │                    │
│  │ 重要性评分      │                   │                    │
│  └──────┬──────────┘                   │                    │
│         │                              │                    │
│         ↓                              │                    │
│  ┌─────────────────┐                   │                    │
│  │ 向量化(Embedding)│                   │                    │
│  │ titleVector     │                   │                    │
│  │ summaryVector   │                   │                    │
│  └──────┬──────────┘                   │                    │
│         │                              │                    │
│         ↓                              ↓                    │
│  ┌─────────────────────────────────────────────┐            │
│  │              Elasticsearch                   │            │
│  │  financial_article | sector_money_flow |     │            │
│  │                      sector_quote            │            │
│  └─────────────────────────────────────────────┘            │
└─────────────────────────────────────────────────────────────┘
```

### 2. 分析流程（每日自动 / 用户触发）

```
┌─────────────────────────────────────────────────────────────┐
│  触发方式                                                    │
│  ├─ 每日自动：收盘后分析Top10板块                           │
│  └─ 用户触发：指定板块分析                                  │
└───────────────────────────┬─────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  AnalysisAgentOrchestrator (分析编排器)                      │
├─────────────────────────────────────────────────────────────┤
│  1. 解析请求 → 识别分析目标(板块:半导体, 时间:今日)          │
│  2. 数据检索阶段                                            │
│     ├─ NewsRetriever: 向量语义检索相关新闻                  │
│     │   → 查询词向量化 → KNN检索 → 相关新闻Top N            │
│     └─ SectorDataRetriever: 查询板块结构化数据              │
│         → 资金流向、涨跌幅、近N日趋势                       │
│  3. Agent分析阶段 (可并行)                                  │
│     ├─ PolicyAgent: 分析相关政策新闻影响                    │
│     ├─ SectorAgent: 分析资金流向+热度                       │
│     └─ TrendAgent: 分析趋势信号                             │
│  4. 报告生成                                                │
│     └─ ReportGenerator: 整合各Agent输出                     │
└───────────────────────────┬─────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  输出: AnalysisReport（详见"报告展示设计"章节）              │
├─────────────────────────────────────────────────────────────┤
│  L1 信号卡片  → 综合评级 + 四维信号灯 + 一句话总结          │
│  L2 数据看板  → 涨跌幅/资金流向/换手率等核心指标            │
│  L3 详细分析  → 消息面/资金面/趋势研判                      │
│  L4 操作参考  → 关键价位 + 风控建议（可选）                 │
└─────────────────────────────────────────────────────────────┘
```

## 报告展示设计

### 设计原则

```
用户核心需求：快速判断 → 是否值得关注 → 是否入场/退场

设计目标：
✓ 5秒内看懂核心结论
✓ 30秒内了解关键依据
✓ 3分钟内完成深度阅读
```

### 信息层级

| 层级 | 用时 | 内容 | 用户目标 |
|-----|------|------|---------|
| **L1 信号卡片** | 5秒 | 综合评级 + 四维信号灯 + 一句话总结 | 是否值得关注 |
| **L2 数据看板** | 30秒 | 核心数据 + 趋势图 | 了解当前状态 |
| **L3 详细分析** | 3分钟 | 消息面/资金面/趋势研判 | 理解背后逻辑 |
| **L4 操作参考** | 可选 | 关键价位 + 风控建议 | 辅助决策 |

### L1 核心信号卡片（5秒决策）

```
┌─────────────────────────────────────────────────────────────────┐
│  半导体                                          2025-01-13    │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│     📈 综合评级：偏多                                           │
│     ━━━━━━━━━━━━━━━━━━━━━━━━━●━━━━━                             │
│     偏空        中性        偏多        强势                    │
│                                                                 │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐        │
│  │ 消息面    │  │ 资金面    │  │ 技术面    │  │ 情绪面    │        │
│  │   🟢      │  │   🟢      │  │   🟡      │  │   🟢      │        │
│  │  利好     │  │  流入     │  │  震荡     │  │  偏热     │        │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘        │
│                                                                 │
│  💡 一句话总结：政策持续加码叠加资金连续流入，短期有望延续强势   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### L2 关键数据看板（30秒了解）

```
┌─────────────────────────────────────────────────────────────────┐
│  📊 数据看板                                                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  今日表现                          资金动向                     │
│  ┌─────────────────────┐          ┌─────────────────────┐      │
│  │ 涨跌幅    +2.35%    │          │ 主力净流入  +8.2亿  │      │
│  │ 排名      3/148     │          │ 连续流入    3天     │      │
│  │ 领涨股    中芯国际   │          │ 北向资金    +2.1亿  │      │
│  │ 换手率    4.2%      │          │ 大单占比    58%↑    │      │
│  └─────────────────────┘          └─────────────────────┘      │
│                                                                 │
│  近5日走势                         资金流向趋势                 │
│  ┌─────────────────────┐          ┌─────────────────────┐      │
│  │     ╱╲                │          │ ████████████  +8.2亿│      │
│  │    ╱  ╲   ╱          │          │ ██████████    +6.1亿│      │
│  │   ╱    ╲ ╱           │          │ ████████      +4.3亿│      │
│  │  ╱      ╱            │          │ ██            -0.8亿│      │
│  │ ╱                    │          │ █████         +2.1亿│      │
│  │ 1/9  1/10 1/11 1/13  │          │ 1/9  1/10 1/11 1/13 │      │
│  └─────────────────────┘          └─────────────────────┘      │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### L3 多维分析详情（3分钟深度）

#### 消息面分析

```
┌─────────────────────────────────────────────────────────────────┐
│  📰 消息面分析                                           🟢 利好 │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  【核心驱动】                                                   │
│  • 国家大基金三期首批项目落地，重点投向先进制程和设备材料       │
│  • 华为Mate70发布带动国产芯片预期，产业链公司订单饱满           │
│                                                                 │
│  【潜在风险】                                                   │
│  • 美国芯片出口管制新规细则待落地，关注1月底政策窗口            │
│                                                                 │
│  【相关新闻】                                                   │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 🔴 重要 │ 国家大基金三期首批项目正式签约        01-13 10:30 │   │
│  │ 🟡 关注 │ 华为发布新一代麒麟芯片                01-13 09:15 │   │
│  │ 🟡 关注 │ 中芯国际产能利用率提升至90%          01-12 16:20 │   │
│  │ ⚪ 一般 │ 半导体设备招标公告发布               01-12 14:00 │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

#### 资金面分析

```
┌─────────────────────────────────────────────────────────────────┐
│  💰 资金面分析                                           🟢 流入 │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  【主力动向】                                                   │
│  • 主力资金连续3日净流入，累计金额达18.6亿元                   │
│  • 超大单占比从上周42%提升至58%，机构参与度明显提升            │
│  • 北向资金连续5日增持半导体ETF，持仓创近3月新高               │
│                                                                 │
│  【资金结构】                                                   │
│  超大单  ████████████████████  +4.8亿  (58%)                   │
│  大单    ████████████          +3.4亿  (41%)                   │
│  中单    ██                    -0.5亿  (-6%)                   │
│  小单    ██                    +0.5亿  (7%)                    │
│                                                                 │
│  【信号解读】                                                   │
│  超大单持续流入 + 散户跟进有限 = 机构主导行情，持续性较强       │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

#### 趋势研判

```
┌─────────────────────────────────────────────────────────────────┐
│  📈 趋势研判                                                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  【短期 1-5日】                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 观点：震荡偏强                                           │   │
│  │ 依据：资金持续流入 + 政策催化 + 技术面临近前高压力位      │   │
│  │ 关注：能否放量突破1月8日高点，若突破则打开上行空间        │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  【中期 1-4周】                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 观点：谨慎乐观                                           │   │
│  │ 依据：大基金三期落地提供中期支撑，但需关注外部政策扰动    │   │
│  │ 风险点：1月底美国芯片新规细则、春节前资金回流压力         │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  【关键价位】                                                   │
│  支撑位：2850点（前低）  │  压力位：3120点（前高）             │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### L4 操作参考区（辅助决策）

```
┌─────────────────────────────────────────────────────────────────┐
│  🎯 操作参考                                                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌───────────────────┐  ┌───────────────────┐                  │
│  │ 📗 做多参考        │  │ 📕 风控参考        │                  │
│  ├───────────────────┤  ├───────────────────┤                  │
│  │ 条件：放量突破3120 │  │ 止损：跌破2850    │                  │
│  │ 仓位：建议≤30%    │  │ 减仓：跌破2950    │                  │
│  │ 周期：短线为主     │  │ 注意：春节前降仓  │                  │
│  └───────────────────┘  └───────────────────┘                  │
│                                                                 │
│  ⚠️ 风险提示：以上仅为数据分析结果，不构成投资建议。            │
│     投资有风险，入市需谨慎。                                    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 多板块对比视图（默认Top10场景）

```
┌─────────────────────────────────────────────────────────────────┐
│  📊 今日板块热力图                              2025-01-13      │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  板块          涨幅    资金     消息   综合    操作              │
│  ─────────────────────────────────────────────────────────────  │
│  1. 半导体     +2.35%  +8.2亿   🟢    📈偏多  [查看详情]        │
│  2. 人工智能   +1.89%  +6.1亿   🟢    📈偏多  [查看详情]        │
│  3. 机器人     +1.56%  +4.3亿   🟢    📈偏多  [查看详情]        │
│  4. 新能源车   +0.82%  +2.1亿   🟡    ➡️中性  [查看详情]        │
│  5. 光伏       +0.45%  -1.2亿   🟡    ➡️中性  [查看详情]        │
│  ─────────────────────────────────────────────────────────────  │
│  6. 白酒       -0.32%  -2.1亿   🟡    ➡️中性  [查看详情]        │
│  7. 医药       -0.68%  -3.2亿   🟡    📉偏空  [查看详情]        │
│  8. 房地产     -1.25%  -5.6亿   🔴    📉偏空  [查看详情]        │
│  ...                                                            │
│                                                                 │
│  💡 今日主线：科技股强势，半导体领涨，政策驱动明显              │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### Agent输出数据结构

```json
{
  "sectorName": "半导体",
  "tradeDate": "2025-01-13",
  "overallSignal": "BULLISH",
  "overallScore": 72,
  "summary": "政策持续加码叠加资金连续流入，短期有望延续强势",
  "dimensions": {
    "news": { "signal": "POSITIVE", "summary": "政策利好，大基金三期落地" },
    "capital": { "signal": "POSITIVE", "summary": "主力连续3日净流入" },
    "technical": { "signal": "NEUTRAL", "summary": "临近前高压力位" },
    "sentiment": { "signal": "POSITIVE", "summary": "市场情绪偏热" }
  },
  "newsAnalysis": {
    "coreDrivers": ["国家大基金三期首批项目落地", "华为Mate70发布带动预期"],
    "potentialRisks": ["美国芯片出口管制新规待落地"],
    "relatedNews": []
  },
  "capitalAnalysis": {
    "mainNetInflow": 820000000,
    "consecutiveDays": 3,
    "superLargeRatio": 0.58,
    "interpretation": "机构主导行情，持续性较强"
  },
  "trendPrediction": {
    "shortTerm": { "view": "震荡偏强", "basis": "资金持续流入+政策催化" },
    "midTerm": { "view": "谨慎乐观", "basis": "大基金三期提供支撑" }
  },
  "keyLevels": {
    "support": 2850,
    "resistance": 3120
  },
  "riskWarning": "以上仅为数据分析结果，不构成投资建议"
}
```

### 展示载体

| 载体 | 优势 | 劣势 | 定位 |
|-----|------|------|------|
| **Web页面** | 信息密度高、可视化丰富 | 需开发前端 | 主力载体 |
| **微信公众号** | 触达方便、可订阅推送 | 排版受限 | 每日摘要推送 |
| **API接口** | 灵活对接 | 需二次开发 | 后期扩展 |

## 技术栈

- Java 21 + Spring Boot 3.x
- Elasticsearch（数据存储 + 向量检索）
- 通义千问（摘要提取 + Embedding）
- Google Gemini / 智谱AI（LLM分析）
- 虚拟线程（高并发数据采集）